1 REM UNFINISHED CLOCK
10 GOTO 1000
100 REM PRINT AT Y,X WITH KERNAL ROUTINE PLOT
110 S=0
120 POKE 781,Y:POKE 782,X:POKE 783,S:SYS $FFF0
130 RETURN
200 REM READ COORDINATES OF CURSOR POSITION
210 S=1
220 POKE 783,S:SYS $FFF0:Y=PEEK(781):X=PEEK(782)
230 RETURN
400 REM LINE FROM (A,B) TO (C,D) (ZX81 BASIC PROGRAMMING CH 18)
403 U=C-A
410 V=D-B
420 X1=SGN(U)
430 Y1=SGN(V)
440 X2=SGN(U)
450 Y2=0
460 M=ABS(U)
470 N=ABS(V)
480 IF M>N THEN GOTO 540
490 X2=0
500 Y2=SGN(V)
510 M=ABS(V)
520 N=ABS(U)
540 SU=INT(M/2)
550 FOR I=0 TO M
560 X=A:Y=B:GOSUB 100:PRINT A$;
570 SU=SU+N
580 IF SU<M THEN GOTO 630
590 SU=SU-M
600 A=A+X1
610 B=B+Y1
620 GOTO 650
630 A=A+X2
640 B=B+Y2
650 NEXT I
660 RETURN
1000 REM MAIN
1005 PI=4*ATN(1)
1007 C=40:D=30
1010 PRINT CHR$($93);:REM CLS
1020 H=PI/2
1021 FOR I=0 TO 59
1022 X=-30*COS(H)+40:Y=-30*SIN(H)+30:GOSUB 100:PRINT "#";
1023 H=H+PI/30
1024 NEXT I
1025 H=PI/2
1026 IF TI-T<30 THEN GOTO 1026
1027 T=TI
1028 A=XS:B=YS:A$=" ":GOSUB 400
1030 A=-28*COS(H)+40:B=-28*SIN(H)+30:XS=A:YS=B:A$="*":GOSUB 400
1040 PRINT CHR$($13);TI$;
1070 H=H+PI/30
1080 GOTO 1026
1090 END
